{"version":3,"file":"index.js","sources":["../source/types.ts","../source/get-export-text.ts","../source/index.ts"],"sourcesContent":["export enum Selector {\n    jsonScript = 'script[type=\"application/json\"]'\n}\n\nexport enum Extension {\n    json = 'json',\n    js = 'js'\n}\n\nexport enum StringConstant {\n    nothing = '',\n    period = '.',\n    space = ' ',\n    backTick = '`'\n}\n\nexport enum CommandlineArgument {\n    file = 'file'\n}\n\nexport enum CommandlineArgumentShort {\n    file = 'f'\n}\n\nexport enum MimeType {\n    json = 'application/json'\n}\n\nexport interface IExportToBrowserJson {\n    file: string;\n}\n\nexport interface IGetExportText {\n    fileText: string;\n    name: string;\n}\n\nexport const regex = {\n    newlines: /\\n/msg,\n    multiSpaces: /\\s{2,}/msg,\n    backTicks: /`/msg,\n    doubleQuotes: /\"/msg\n}","import {\n    IGetExportText,\n    Selector,\n    MimeType,\n    StringConstant,\n    regex\n} from './types';\n\nconst { jsonScript: prefix } = Selector;\nconst { multiSpaces, newlines  } = regex;\nconst { space } = StringConstant;\n\nexport default ({ fileText, name }: IGetExportText) => `(() => {\n    const selector = '${prefix}[data-name=\"${name}\"]';\n    const existingScript = document.head.querySelector(selector);\n    const script = !existingScript && document.createElement('script');\n    const json = script && {\n        json: \"${fileText}\"\n    };\n\n    if (script) {\n        script.dataset.name = '${name}';\n        script.type = '${MimeType.json}';\n        script.innerHTML = JSON.stringify(json);\n        document.head.appendChild(script);\n    }\n})();`\n.trim()\n.replace(multiSpaces, space)\n.replace(newlines, space);","import { dirname, basename, resolve as resolvePath } from 'path';\nimport getFileText from 'vamtiger-get-file-text';\nimport createFile from 'vamtiger-create-file';\nimport Args from 'vamtiger-argv/build/main';\nimport {\n    IExportToBrowserJson,\n    Extension,\n    StringConstant,\n    CommandlineArgument,\n    CommandlineArgumentShort,\n    regex\n} from './types';\nimport getExportText from './get-export-text';\n\nconst { cwd: getWorkingDirectory } = process;\nconst args = new Args();\nconst { period, backTick } = StringConstant;\nconst { doubleQuotes } = regex;\nconst relativeFilePath = args.get(CommandlineArgument.file)\n    || args.get(CommandlineArgumentShort.file);\nconst argumentFile = relativeFilePath && resolvePath(\n    getWorkingDirectory(),\n    relativeFilePath\n);\n\nif (argumentFile) {\n    main({file: argumentFile});\n}\n\nexport default async function main({ file }: IExportToBrowserJson) {\n    const directoryPath = dirname(file);\n    const fileName = basename(file);\n    const exportFileName = [\n        fileName,\n        Extension.json,\n        Extension.js\n    ].join(period);\n    const exportFileNameJson = [\n        fileName,\n        Extension.json,\n    ].join(period);\n    const exportFile = resolvePath(\n        directoryPath,\n        exportFileName\n    );\n    const fileText = await getFileText(file);\n    const rawText = String.raw`${fileText}`\n        .replace(doubleQuotes, backTick);\n    const exportFileText = getExportText({\n        name: exportFileNameJson,\n        fileText: rawText\n    });\n\n    createFile(exportFile, exportFileText);\n}"],"names":["Selector","Extension","StringConstant","CommandlineArgument","CommandlineArgumentShort","MimeType","regex","newlines","multiSpaces","backTicks","doubleQuotes","jsonScript","prefix","space","fileText","name","json","trim","replace","cwd","getWorkingDirectory","process","args","Args","period","backTick","relativeFilePath","get","file","argumentFile","resolvePath","main","directoryPath","dirname","fileName","basename","exportFileName","js","join","exportFileNameJson","exportFile","rawText","String","raw","getFileText","exportFileText","getExportText","createFile"],"mappings":"qGAAYA,SAIAC,UAKAC,eAOAC,oBAIAC,yBAIAC,4dAxBZ,SAAYL,GACRA,+CADJ,CAAYA,WAAAA,cAIZ,SAAYC,GACRA,cACAA,UAFJ,CAAYA,YAAAA,eAKZ,SAAYC,GACRA,aACAA,aACAA,YACAA,eAJJ,CAAYA,iBAAAA,oBAOZ,SAAYC,GACRA,cADJ,CAAYA,sBAAAA,yBAIZ,SAAYC,GACRA,WADJ,CAAYA,2BAAAA,8BAIZ,SAAYC,GACRA,0BADJ,CAAYA,WAAAA,cAaZ,MAAaC,OACTC,SAAU,QACVC,YAAa,YACbC,UAAW,OACXC,aAAc,SCjCVC,WAAYC,QAAWZ,UACzBQ,YAAEA,YAAWD,SAAEA,UAAcD,OAC7BO,MAAEA,OAAUX,eAElB,kBAAe,EAAGY,SAAAA,EAAUC,KAAAA,wCACJH,qBAAqBG,mMAI5BD,mEAIgBC,+BACRV,SAASW,qHAKjCC,OACAC,QAAQV,YAAaK,OACrBK,QAAQX,SAAUM,OCfnB,MAAQM,IAAKC,qBAAwBC,QAC/BC,KAAO,IAAIC,MACXC,OAAEA,OAAMC,SAAEA,UAAavB,gBACvBQ,aAAEA,cAAiBJ,MACnBoB,iBAAmBJ,KAAKK,IAAIxB,oBAAoByB,OAC/CN,KAAKK,IAAIvB,yBAAyBwB,MACnCC,aAAeH,kBAAoBI,aACrCV,sBACAM,kBAOJ,SAA8BK,MAAKH,KAAEA,oDACjC,MAAMI,EAAgBC,aAAQL,GACxBM,EAAWC,cAASP,GACpBQ,GACFF,EACAjC,UAAUe,KACVf,UAAUoC,IACZC,KAAKd,QACDe,GACFL,EACAjC,UAAUe,MACZsB,KAAKd,QACDgB,EAAaV,aACfE,EACAI,GAGEK,EAAUC,OAAOC,YADAC,YAAYhB,KAE9BV,QAAQR,aAAce,UACrBoB,EAAiBC,eACnB/B,KAAMwB,EACNzB,SAAU2B,IAGdM,WAAWP,EAAYK,KA5BvBhB,cACAE,MAAMH,KAAMC"}